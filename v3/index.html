<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>RePhone — A melhor oferta, do jeito certo</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="RePhone: você define quanto quer pagar. A plataforma encontra os anúncios mais compatíveis com segurança." />
  <link rel="icon" href="assets/favicon.svg" />
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div id="gate" style="display:none; position:fixed; inset:0; background:rgba(255,255,255,.96); z-index:9999; padding:24px;">
  <div style="max-width:520px; margin:10vh auto; border:1px solid rgba(0,0,0,.12); border-radius:16px; padding:18px; background:#fff;">
    <h2 style="margin:0 0 8px;">Acesso ao V3</h2>
    <p style="margin:0 0 14px; color:#334155;">
      Peça autorização no WhatsApp e cole o código aqui.
      <br><b>Obs:</b> o acesso é temporário e pode ser revogado a qualquer momento.
    </p>

    <div style="display:flex; gap:10px; flex-wrap:wrap;">
      <input id="gateToken" placeholder="Cole o código (ex: XXX-XXXX)"
             style="flex:1; min-width:220px; padding:12px 14px; border-radius:12px; border:1px solid rgba(0,0,0,.15);" />
      <button id="gateBtn" style="padding:12px 14px; border-radius:999px; border:1px solid rgba(0,0,0,.12); background:#16a34a; color:#fff; font-weight:700;">
        Entrar
      </button>
      <a id="gateWa" href="#" style="padding:12px 14px; border-radius:999px; border:1px solid rgba(0,0,0,.12); background:#fff; font-weight:700;">
        Pedir acesso
      </a>
    </div>
  </div>
  </div>
  <header class="site-header">
    <div class="container topbar">
      <a class="brand" href="#">
        <img src="assets/logo-rephone.svg" alt="RePhone" class="brand-logo" />
        <div class="brand-text">
          <div class="brand-name">RePhone</div>
          <div class="brand-tagline">A melhor oferta, do jeito certo.</div>
        </div>
      </a>

      <div class="search-wrap" role="search">
        <input class="search" id="searchInput" placeholder="Buscar celular ou modelo" autocomplete="off" />
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container">
        <h1>A melhor oferta, do jeito certo.</h1>
        <p class="lead">Você define quanto quer pagar. A RePhone encontra os anúncios mais compatíveis com segurança.</p>

        <div class="price-box" aria-label="Definir valor máximo">
          <label class="price-label" for="priceInput">Quanto você quer pagar?</label>
          <div class="price-row">
            <span class="currency">R$</span>
            <input id="priceInput" class="price-input" inputmode="decimal" placeholder="1.500,00" aria-describedby="priceHint" />
          </div>
          <div class="price-hint" id="priceHint">Dica: digite <strong>1500</strong>, <strong>1.500</strong> ou <strong>1.500,00</strong> — a RePhone padroniza automaticamente.</div>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container section-head">
        <h2>Ofertas em destaque</h2>
        <div class="loading" id="loadingLabel" aria-live="polite">Carregando ofertas...</div>
      </div>

      <div class="container">
        <div class="filters" role="tablist" aria-label="Filtros de ofertas">
          <button class="chip active" data-filter="all" type="button">Todos</button>
          <button class="chip" data-filter="near" type="button">Perto</button>
          <button class="chip" data-filter="verified" type="button">Vendedor verificado</button>
          <button class="chip" data-filter="delivery" type="button">Entrega</button>
        </div>

        <div class="grid" id="offersGrid" aria-label="Lista de ofertas"></div>
      </div>
    </section>
  </main>

  <!-- Barra do MATCH (fixa) -->
  <div class="matchbar" id="matchBar" aria-live="polite" aria-hidden="true">
    <div class="matchbar-inner">
      <div class="matchbar-left">
        <div class="matchbar-title" id="matchTitle">Buscando MATCH…</div>
        <div class="matchbar-sub" id="matchSub">Comparando preço, distância e segurança</div>
        <div class="matchbar-progress" aria-hidden="true"><span></span></div>
      </div>
      <button class="matchbar-btn" id="matchBtn" type="button" disabled>Ver MATCH</button>
    </div>
  </div>

  <!-- Modal do MATCH -->
  <div class="modal-backdrop" id="matchModalBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="matchModalTitle">
      <div class="modal-head">
        <div>
          <div class="modal-kicker">MATCH RePhone</div>
          <h3 id="matchModalTitle">Encontramos uma oferta para você</h3>
        </div>
        <button class="icon-btn" id="closeMatchModal" type="button" aria-label="Fechar">✕</button>
      </div>

      <div class="modal-body" id="matchModalBody"></div>

      <div class="modal-actions">
        <a class="btn btn-ghost" href="#priceInput" id="adjustPrice">Ajustar valor</a>
        <a class="btn btn-primary" href="#" id="openOfferLink">Abrir anúncio</a>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-inner">
      <span>RePhone © — A melhor oferta, do jeito certo.</span>
    </div>
  </footer>

  <script src="js/app.js"></script>
  <script>
  const OWNER_WA = "5527998205547"; // seu WhatsApp

  // ✅ ESTE é o código único do momento
  // Quando você quiser revogar: troque este valor e faça commit.
  const ACCESS_CODE = "RPH-8742";

  // Gate sempre aparece ao entrar no V3 (não salva sessão)
  function showGate(){
    document.getElementById("gate").style.display = "block";
    document.body.style.overflow = "hidden";
  }
  function hideGate(){
    document.getElementById("gate").style.display = "none";
    document.body.style.overflow = "";
  }

  // Botão WhatsApp
  const waLink = document.getElementById("gateWa");
  if(waLink){
    const msg = encodeURIComponent(
      "Olá! Quero acesso ao V3 do RePhone. Meu nome é: ______. Pode me liberar o código temporário?"
    );
    waLink.href = `https://wa.me/${OWNER_WA}?text=${msg}`;
    waLink.target = "_blank";
    waLink.rel = "noopener";
  }

  // Se vier por URL (?token=RPH-8742), preenche automático
  const u = new URL(window.location.href);
  const tokenFromUrl = u.searchParams.get("token");
  if(tokenFromUrl){
    document.getElementById("gateToken").value = tokenFromUrl;
  }

  // Sempre bloqueia até validar
  showGate();

  document.getElementById("gateBtn").addEventListener("click", function(){
    const t = (document.getElementById("gateToken").value || "").trim();

    if(t === ACCESS_CODE){
      hideGate();

      // limpa ?token da URL (pra não ficar exposto)
      const clean = new URL(window.location.href);
      clean.searchParams.delete("token");
      window.history.replaceState({}, "", clean.toString());

      // Opcional: cria um botão flutuante pra "Sair" e revogar acesso no navegador da pessoa
      const exit = document.createElement("button");
      exit.textContent = "Encerrar acesso";
      exit.style.cssText = "position:fixed; bottom:16px; right:16px; z-index:9998; padding:10px 12px; border-radius:999px; border:1px solid rgba(0,0,0,.12); background:#fff; font-weight:700;";
      exit.addEventListener("click", () => location.reload()); // volta pro gate
      document.body.appendChild(exit);

    }else{
      alert("Código inválido ou acesso revogado. Peça autorização no WhatsApp.");
    }
  });
          </script>
</body>
</html>
